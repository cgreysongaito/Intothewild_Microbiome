## create lookup table more programmatically
donors <- df_Transplant %>%
dplyr::select(`Donor Taxon`) %>%
unique() %>%
arrange(`Donor Taxon`) %>%
pull()
donors <- tibble(`Donor Taxon` = donors) %>%
mutate(LabRodent.Donor = ifelse(`Donor Taxon` %in% labrodents, "LabRodent", "Other"))
df_Transplant %>%
dplyr::select(`Recipient Taxon`, LabRodent.Recip, LabRodent.Donor) %>%
View()
## create new column with lookup table and left_join
df_Transplant <- left_join(df_Transplant, recipients, by = "Recipient Taxon") %>%
left_join(donors, by = "Donor Taxon")
df_Transplant %>%
dplyr::select(`Recipient Taxon`, LabRodent.Recip, LabRodent.Donor) %>%
View()
recipients <- df_Transplant %>%
dplyr::select(`Recipient Taxon`) %>%
unique() %>%
arrange(`Recipient Taxon`) %>%
pull()
recipients <- tibble(`Recipient Taxon` = recipients) %>%
mutate(LabRodent.Recip = ifelse(`Recipient Taxon` %in% labrodents, "LabRodent", "Other"))
## create new column with lookup table and left_join
df_Transplant <- left_join(df_Transplant, recipients, by = "Recipient Taxon") %>%
left_join(donors, by = "Donor Taxon")
df_Transplant %>%
dplyr::select(`Recipient Taxon`, LabRodent.Recip, LabRodent.Donor) %>%
View()
df_Transplant <- gs_url("https://docs.google.com/spreadsheets/d/1WhRjoIFJWAAGvsFNHbrf2GZp8K6pNtxoudrhZ6h82ZM/edit") %>%
# create unique identifyer
gs_read() %>%
# reads the data into R
write_csv(paste(Sys.Date(), "Microbiome_Literature_Summaries.csv"))
theme_simple <- function() {
theme_grey() %+replace%
theme(
axis.line = element_line(colour = "black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
axis.title = element_text(size = 28, face = "bold"),
axis.text.x = element_text(size = 15, colour = "Black"),
axis.text.y = element_text(size = 15, colour = "Black"),
axis.ticks.length = unit(0.25, "cm"),
axis.ticks = element_line(size = 0.5, colour = "Black"),
panel.border = element_rect(fill = FALSE, size = 0.5),
legend.title = element_text(size = 15),
legend.key = element_blank()
)
}
library("tidyverse")
theme_set(theme_simple())
library(viridis)
library(googlesheets)
# + scale_color/fill_viridis(discrete = T/F)
# theme_set(theme_light())
# Startup ends here
## Read in data -----
df_Transplant <- gs_url("https://docs.google.com/spreadsheets/d/1WhRjoIFJWAAGvsFNHbrf2GZp8K6pNtxoudrhZ6h82ZM/edit") %>%
# create unique identifyer
gs_read() %>%
# reads the data into R
write_csv(paste(Sys.Date(), "Microbiome_Literature_Summaries.csv"))
attr(df_Transplant, "CreatedOn") <- Sys.Date()
## create lookup table more programmatically
donors <- df_Transplant %>%
dplyr::select(`Donor Taxon`) %>%
unique() %>%
arrange(`Donor Taxon`) %>%
pull()
donors
donors <- tibble(`Donor Taxon` = donors) %>%
mutate(LabRodent.Donor = ifelse(`Donor Taxon` %in% labrodents, "LabRodent", "Other"))
donors <- tibble(`Donor Taxon` = donors) %>%
mutate(LabRodent.Donor = ifelse(`Donor Taxon` %in% labrodents, "LabRodent", "Other"))
labrodents <- c("Mice", "mice", "mouse", "rat", "rats")
donors <- df_Transplant %>%
dplyr::select(`Donor Taxon`) %>%
unique() %>%
arrange(`Donor Taxon`) %>%
pull()
donors
donors <- tibble(`Donor Taxon` = donors) %>%
mutate(LabRodent.Donor = ifelse(`Donor Taxon` %in% labrodents, "LabRodent", "Other"))
recipients <- df_Transplant %>%
dplyr::select(`Recipient Taxon`) %>%
unique() %>%
arrange(`Recipient Taxon`) %>%
pull()
recipients # check which are rodents
recipients <- tibble(`Recipient Taxon` = recipients) %>%
mutate(LabRodent.Recip = ifelse(`Recipient Taxon` %in% labrodents, "LabRodent", "Other"))
recipients %>% View()
donors
## create new column with lookup table and left_join
df_Transplant <- left_join(df_Transplant, recipients, by = "Recipient Taxon") %>%
left_join(donors, by = "Donor Taxon")
df_Transplant %>%
dplyr::select(`Recipient Taxon`, LabRodent.Recip, LabRodent.Donor) %>%
View()
df_Transplant %>%
dplyr::select(`Donor Taxon`, LabRodent.Donor,`Recipient Taxon`, LabRodent.Recip, ) %>%
View()
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip)
setwd("/home/chrisgg/Documents/Guelph/Microbiome/meta_transplant_microbiome/")
df_Transplant <- gs_url("https://docs.google.com/spreadsheets/d/1WhRjoIFJWAAGvsFNHbrf2GZp8K6pNtxoudrhZ6h82ZM/edit") %>%
# create unique identifyer
gs_read() %>%
# reads the data into R
write_csv(paste(Sys.Date(), "Microbiome_Literature_Summaries.csv"))
# and automatically create timestamped .csv for safety and repeatability
## execute line below if you want to repeat analysis from a certain date
# df_Transplant = read_csv("2018-11-20 Microbiome_Literature_Summaries.csv")
attr(df_Transplant, "CreatedOn") <- Sys.Date()
theme_simple <- function() {
theme_grey() %+replace%
theme(
axis.line = element_line(colour = "black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
axis.title = element_text(size = 28, face = "bold"),
axis.text.x = element_text(size = 15, colour = "Black"),
axis.text.y = element_text(size = 15, colour = "Black"),
axis.ticks.length = unit(0.25, "cm"),
axis.ticks = element_line(size = 0.5, colour = "Black"),
panel.border = element_rect(fill = FALSE, size = 0.5),
legend.title = element_text(size = 15),
legend.key = element_blank()
)
}
library("tidyverse")
theme_set(theme_simple())
library(viridis)
library(googlesheets)
# + scale_color/fill_viridis(discrete = T/F)
# theme_set(theme_light())
# Startup ends here
## Read in data -----
df_Transplant <- gs_url("https://docs.google.com/spreadsheets/d/1WhRjoIFJWAAGvsFNHbrf2GZp8K6pNtxoudrhZ6h82ZM/edit") %>%
# create unique identifyer
gs_read() %>%
# reads the data into R
write_csv(paste(Sys.Date(), "Microbiome_Literature_Summaries.csv"))
# and automatically create timestamped .csv for safety and repeatability
## execute line below if you want to repeat analysis from a certain date
# df_Transplant = read_csv("2018-11-20 Microbiome_Literature_Summaries.csv")
attr(df_Transplant, "CreatedOn") <- Sys.Date()
labrodents <- c("Mice", "mice", "mouse", "rat", "rats")
donors <- df_Transplant %>%
dplyr::select(`Donor Taxon`) %>%
unique() %>%
arrange(`Donor Taxon`) %>%
pull()
donors
donors <- tibble(`Donor Taxon` = donors) %>%
mutate(LabRodent.Donor = ifelse(`Donor Taxon` %in% labrodents, "LabRodent", "Other"))
recipients <- df_Transplant %>%
dplyr::select(`Recipient Taxon`) %>%
unique() %>%
arrange(`Recipient Taxon`) %>%
pull()
recipients # check which are rodents
recipients <- tibble(`Recipient Taxon` = recipients) %>%
mutate(LabRodent.Recip = ifelse(`Recipient Taxon` %in% labrodents, "LabRodent", "Other"))
## create new column with lookup table and left_join
df_Transplant <- left_join(df_Transplant, recipients, by = "Recipient Taxon") %>%
left_join(donors, by = "Donor Taxon")
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip)
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0),LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0))
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0))
?cumsum
test <- c(1,0,0,0,1)
test==0
sum(test==0)
count(test==3)
count(test==1)
sum(test==1)
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0))
#Figure of cumulative number of species over time
test <- df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0))
cumsum(test$DonorLabRodent)
#Figure of cumulative number of species over time
test <- df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) )
test
#Figure of cumulative number of species over time
test <- df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year)
test
View(test)
grep("Donor", test$Type)
grepl("Donor", test$Type)
#Figure of cumulative number of species over time
test <- df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year) %>%
mutate(DonorRecip = ifelse(grepl("Donor", Type),"Donor", "Recipient"))
test
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year) %>%
mutate(DonorRecip = ifelse(grepl("Donor", Type),"Donor", "Recipient")) %>%
ggplot() +
geom_bar(aes(x = Year, y = CumulativeSum, fill = Type ))
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year) %>%
mutate(DonorRecip = ifelse(grepl("Donor", Type),"Donor", "Recipient")) %>%
ggplot() +
geom_bar(aes(x = Year, fill = Type )) +
facet_grid(.~DonorRecip)+
scale_fill_viridis(
name = "Recipient Taxon Type", breaks = c("LabRodent", "Other"),
labels = c("lab rodent", "other"), alpha = 1, begin = 0, end = 1,
direction = 1, discrete = TRUE, option = "D"
)
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year) %>%
mutate(DonorRecip = ifelse(grepl("Donor", Type),"Donor", "Recipient"))
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year) %>%
mutate(DonorRecip = ifelse(grepl("Donor", Type),"Donor", "Recipient")) %>%
mutate(Type = str_remove(Type, "Donor")) %>%
mutate(Type = str_remove(Type, "Recip")) %>%
mutate(Type = str_remove(Type, "cs"))
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year) %>%
mutate(DonorRecip = ifelse(grepl("Donor", Type),"Donor", "Recipient")) %>%
mutate(Type = str_remove(Type, "Donor")) %>%
mutate(Type = str_remove(Type, "Recip")) %>%
mutate(Type = str_remove(Type, "cs")) %>%
ggplot() +
geom_bar(aes(x = Year, fill = Type )) +
facet_grid(.~DonorRecip)+
scale_fill_viridis(
name = "Recipient Taxon Type", breaks = c("LabRodent", "Other"),
labels = c("lab rodent", "other"), alpha = 1, begin = 0, end = 1,
direction = 1, discrete = TRUE, option = "D"
)
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year) %>%
mutate(DonorRecip = ifelse(grepl("Donor", Type),"Donor", "Recipient")) %>%
mutate(Type = str_remove(Type, "Donor")) %>%
mutate(Type = str_remove(Type, "Recip")) %>%
mutate(Type = str_remove(Type, "cs")) %>%
ggplot() +
geom_bar(aes(x = Year, y = CumulativeSum, fill = Type )) +
facet_grid(.~DonorRecip)+
scale_fill_viridis(
name = "Recipient Taxon Type", breaks = c("LabRodent", "Other"),
labels = c("lab rodent", "other"), alpha = 1, begin = 0, end = 1,
direction = 1, discrete = TRUE, option = "D"
)
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year) %>%
mutate(DonorRecip = ifelse(grepl("Donor", Type),"Donor", "Recipient")) %>%
mutate(Type = str_remove(Type, "Donor")) %>%
mutate(Type = str_remove(Type, "Recip")) %>%
mutate(Type = str_remove(Type, "cs")) %>%
ggplot(aes(x = Year, y = CumulativeSum) )+
geom_bar(aes(fill = Type )) +
facet_grid(.~DonorRecip)+
scale_fill_viridis(
name = "Recipient Taxon Type", breaks = c("LabRodent", "Other"),
labels = c("lab rodent", "other"), alpha = 1, begin = 0, end = 1,
direction = 1, discrete = TRUE, option = "D"
)
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year) %>%
mutate(DonorRecip = ifelse(grepl("Donor", Type),"Donor", "Recipient")) %>%
mutate(Type = str_remove(Type, "Donor")) %>%
mutate(Type = str_remove(Type, "Recip")) %>%
mutate(Type = str_remove(Type, "cs")) %>%
ggplot()+
geom_col(aes(x = Year, y = CumulativeSum,fill = Type )) +
facet_grid(.~DonorRecip)+
scale_fill_viridis(
name = "Recipient Taxon Type", breaks = c("LabRodent", "Other"),
labels = c("lab rodent", "other"), alpha = 1, begin = 0, end = 1,
direction = 1, discrete = TRUE, option = "D"
)
df_Transplant %>%
dplyr::select(LabRodent.Recip, starts_with("Eco-Reality")) %>%
# select the relevant columns for the plotting function
gather(starts_with("Eco-Reality of"), key = "Type", value = "Eco-Reality") %>%
mutate(Type = str_remove(Type, "Eco-Reality of ")) %>%
mutate(Type = str_remove(Type, " \\(1-3\\)")) %>%
mutate(Type = str_remove(Type, " \\(1-5\\)")) %>%
mutate(Type = str_remove(Type, " \\(1-2\\)")) %>%
mutate(Type = str_replace(Type, " ", "\n")) %>%
# create the long format for ease of plotting
# not necessary to create individual figures (see code below)
mutate(`Eco-Reality` = as.numeric(`Eco-Reality`),
Type = factor(Type,levels=c("Donor\nEnvironment","Donor\nPhysiology","Transplanted\nMicrobiome","Transplant\nMethod","Recipient\nMicrobiome","Recipient\nEnvironment","Recipient\nPhysiology","Housing\nMethod")))  %>%
# this is needed bc of the NAs and NS from the new articles
# TODO rerun after all the data are added/verified
ggplot() +
geom_col(aes(x = `Eco-Reality`,
fill = LabRodent.Recip)) +
facet_grid (`Eco-Reality Taxon Match` ~ Type, scales = "free_x",space = "free_x") +
theme(legend.position = "top",
strip.background=element_blank(),strip.text.x=element_text(size=10),strip.text.y=element_text(size=10),
axis.title.y=element_text(hjust=0.5, vjust=1.5),legend.text=element_text(size=15)) +
scale_fill_viridis(
name = "Recipient Taxon Type", breaks = c("LabRodent", "Other"),
labels = c("lab rodent", "other"), alpha = 1, begin = 0, end = 1,
direction = 1, discrete = TRUE, option = "D"
) +
scale_x_continuous(breaks = function(x) pretty(x)[pretty(x) %% 1 == 0]) +
# https://stackoverflow.com/questions/15622001/how-to-display-only-integer-values-on-an-axis-using-ggplot2
xlab("Eco-Reality")+ylab("Count")
df_Transplant %>%
dplyr::select(LabRodent.Recip, starts_with("Eco-Reality")) %>%
# select the relevant columns for the plotting function
gather(starts_with("Eco-Reality of"), key = "Type", value = "Eco-Reality") %>%
mutate(Type = str_remove(Type, "Eco-Reality of ")) %>%
mutate(Type = str_remove(Type, " \\(1-3\\)")) %>%
mutate(Type = str_remove(Type, " \\(1-5\\)")) %>%
mutate(Type = str_remove(Type, " \\(1-2\\)")) %>%
mutate(Type = str_replace(Type, " ", "\n")) %>%
# create the long format for ease of plotting
# not necessary to create individual figures (see code below)
mutate(`Eco-Reality` = as.numeric(`Eco-Reality`),
Type = factor(Type,levels=c("Donor\nEnvironment","Donor\nPhysiology","Transplanted\nMicrobiome","Transplant\nMethod","Recipient\nMicrobiome","Recipient\nEnvironment","Recipient\nPhysiology","Housing\nMethod")))  %>%
# this is needed bc of the NAs and NS from the new articles
# TODO rerun after all the data are added/verified
ggplot() +
geom_bar(aes(x = `Eco-Reality`,
fill = LabRodent.Recip)) +
facet_grid (`Eco-Reality Taxon Match` ~ Type, scales = "free_x",space = "free_x") +
theme(legend.position = "top",
strip.background=element_blank(),strip.text.x=element_text(size=10),strip.text.y=element_text(size=10),
axis.title.y=element_text(hjust=0.5, vjust=1.5),legend.text=element_text(size=15)) +
scale_fill_viridis(
name = "Recipient Taxon Type", breaks = c("LabRodent", "Other"),
labels = c("lab rodent", "other"), alpha = 1, begin = 0, end = 1,
direction = 1, discrete = TRUE, option = "D"
) +
scale_x_continuous(breaks = function(x) pretty(x)[pretty(x) %% 1 == 0]) +
# https://stackoverflow.com/questions/15622001/how-to-display-only-integer-values-on-an-axis-using-ggplot2
xlab("Eco-Reality")+ylab("Count")
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year) %>%
mutate(DonorRecip = ifelse(grepl("Donor", Type),"Donor", "Recipient")) %>%
mutate(Type = str_remove(Type, "Donor")) %>%
mutate(Type = str_remove(Type, "Recip")) %>%
mutate(Type = str_remove(Type, "cs")) %>%
ggplot()+
geom_col(aes(x = Year, y = CumulativeSum,fill = Type )) +
facet_grid(.~DonorRecip)+
scale_fill_viridis(
name = "Recipient Taxon Type", breaks = c("LabRodent", "Other"),
labels = c("lab rodent", "other"), alpha = 1, begin = 0, end = 1,
direction = 1, discrete = TRUE, option = "D"
)
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year) %>%
mutate(DonorRecip = ifelse(grepl("Donor", Type),"Donor", "Recipient")) %>%
mutate(Type = str_remove(Type, "Donor")) %>%
mutate(Type = str_remove(Type, "Recip")) %>%
mutate(Type = str_remove(Type, "cs")) %>%
ggplot()+
geom_col(aes(x = Year, y = CumulativeSum,fill = Type )) +
facet_grid(.~DonorRecip)+
theme(strip.background=element_blank(),strip.text.x=element_text(size=10),strip.text.y=element_text(size=10),
axis.title.y=element_text(hjust=0.5, vjust=1.5),legend.text=element_text(size=15)) +
scale_fill_viridis(
name = "Recipient Taxon Type", breaks = c("LabRodent", "Other"),
labels = c("lab rodent", "other"), alpha = 1, begin = 0, end = 1,
direction = 1, discrete = TRUE, option = "D"
)
ggsave(paste(Sys.Date(), "CumulativeSum.pdf"),
width = 15, height = 12, units = "cm"
)
#Figure of cumulative number of species over time
df_Transplant %>%
select(PdFName,Year,LabRodent.Donor,LabRodent.Recip) %>%
mutate(LabRodent.DonorBin = ifelse(LabRodent.Donor == "LabRodent",1,0),LabRodent.RecipBin = ifelse(LabRodent.Recip == "LabRodent",1,0)) %>%
group_by(Year) %>%
summarise(DonorLabRodent = sum(LabRodent.DonorBin==1),DonorOther = sum(LabRodent.DonorBin==0),RecipLabRodent = sum(LabRodent.RecipBin==1), RecipOther = sum(LabRodent.RecipBin==0)) %>%
mutate(DonorLabRodentcs = cumsum(DonorLabRodent), DonorOthercs = cumsum(DonorOther) , RecipLabRodentcs = cumsum(RecipLabRodent), RecipOthercs = cumsum (RecipOther) ) %>%
select(-c(DonorLabRodent,DonorOther,RecipLabRodent,RecipOther))%>%
gather(Type, CumulativeSum, -Year) %>%
mutate(DonorRecip = ifelse(grepl("Donor", Type),"Donor", "Recipient")) %>%
mutate(Type = str_remove(Type, "Donor")) %>%
mutate(Type = str_remove(Type, "Recip")) %>%
mutate(Type = str_remove(Type, "cs")) %>%
ggplot()+
geom_col(aes(x = Year, y = CumulativeSum,fill = Type )) +
facet_grid(.~DonorRecip)+
theme(strip.background=element_blank(),strip.text.x=element_text(size=10),strip.text.y=element_text(size=10),
axis.title.y=element_text(hjust=0.5, vjust=1.5),legend.text=element_text(size=15)) +
scale_fill_viridis(
name = "Taxon Type", breaks = c("LabRodent", "Other"),
labels = c("lab rodent", "other"), alpha = 1, begin = 0, end = 1,
direction = 1, discrete = TRUE, option = "D"
) +
ylab("Cumulative Sum")
ggsave(paste(Sys.Date(), "CumulativeSum.pdf"),
width = 18, height = 12, units = "cm"
)
ggsave(paste(Sys.Date(), "CumulativeSum.pdf"),
width = 10, height = 6, units = "cm"
)
ggsave(paste(Sys.Date(), "CumulativeSum.pdf"),
width = 12, height = 6, units = "cm"
)
ggsave(paste(Sys.Date(), "CumulativeSum.pdf"),
width = 18, height = 12, units = "cm"
)
